"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _mysql = _interopRequireDefault(require("mysql2"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// get the client
// create the connection to database
function createConnection() {
  return _mysql.default.createConnection({
    host: process.env.DBHost,
    user: process.env.DBUser,
    password: process.env.DBPassword,
    database: process.env.DBName
  });
}

var getTableList = function getTableList() {
  return new Promise(function (res, rej) {
    var connection = createConnection();
    connection.execute('show tables', function (err, results) {
      if (err) {
        rej(err);
      }

      var tablesList = results.map(function (result) {
        return result["Tables_in_".concat(process.env.DBName)];
      });
      res({
        connection: connection,
        tables: tablesList
      });
    });
  }).then(function (result) {
    result.connection.end();
    return result.tables;
  }).catch(function (err) {
    throw err;
  });
};

var _default = getTableList;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9saXN0VGFibGVzLnRzIl0sIm5hbWVzIjpbImNyZWF0ZUNvbm5lY3Rpb24iLCJteXNxbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiREJIb3N0IiwidXNlciIsIkRCVXNlciIsInBhc3N3b3JkIiwiREJQYXNzd29yZCIsImRhdGFiYXNlIiwiREJOYW1lIiwiZ2V0VGFibGVMaXN0IiwiUHJvbWlzZSIsInJlcyIsInJlaiIsImNvbm5lY3Rpb24iLCJleGVjdXRlIiwiZXJyIiwicmVzdWx0cyIsInRhYmxlc0xpc3QiLCJtYXAiLCJyZXN1bHQiLCJ0YWJsZXMiLCJ0aGVuIiwiZW5kIiwiY2F0Y2giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7OztBQURBO0FBR0E7QUFDQSxTQUFTQSxnQkFBVCxHQUE0QjtBQUMxQixTQUFPQyxlQUFNRCxnQkFBTixDQUF1QjtBQUM1QkUsSUFBQUEsSUFBSSxFQUFFQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsTUFEVTtBQUU1QkMsSUFBQUEsSUFBSSxFQUFFSCxPQUFPLENBQUNDLEdBQVIsQ0FBWUcsTUFGVTtBQUc1QkMsSUFBQUEsUUFBUSxFQUFFTCxPQUFPLENBQUNDLEdBQVIsQ0FBWUssVUFITTtBQUk1QkMsSUFBQUEsUUFBUSxFQUFFUCxPQUFPLENBQUNDLEdBQVIsQ0FBWU87QUFKTSxHQUF2QixDQUFQO0FBTUQ7O0FBRUQsSUFBTUMsWUFBWSxHQUFHLFNBQWZBLFlBQWUsR0FBeUI7QUFDNUMsU0FBTyxJQUFJQyxPQUFKLENBQ0wsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDWixRQUFNQyxVQUFVLEdBQUdoQixnQkFBZ0IsRUFBbkM7QUFDQWdCLElBQUFBLFVBQVUsQ0FBQ0MsT0FBWCxDQUNFLGFBREYsRUFFRSxVQUFDQyxHQUFELEVBQU1DLE9BQU4sRUFBeUM7QUFDdkMsVUFBSUQsR0FBSixFQUFTO0FBQ1BILFFBQUFBLEdBQUcsQ0FBQ0csR0FBRCxDQUFIO0FBQ0Q7O0FBQ0QsVUFBTUUsVUFBb0IsR0FBR0QsT0FBTyxDQUFDRSxHQUFSLENBQVksVUFBQ0MsTUFBRDtBQUFBLGVBQVlBLE1BQU0scUJBQWNuQixPQUFPLENBQUNDLEdBQVIsQ0FBWU8sTUFBMUIsRUFBbEI7QUFBQSxPQUFaLENBQTdCO0FBQ0FHLE1BQUFBLEdBQUcsQ0FBQztBQUFDRSxRQUFBQSxVQUFVLEVBQVZBLFVBQUQ7QUFBYU8sUUFBQUEsTUFBTSxFQUFFSDtBQUFyQixPQUFELENBQUg7QUFDRCxLQVJIO0FBVUQsR0FiSSxFQWNMSSxJQWRLLENBZUwsVUFBQ0YsTUFBRCxFQUFZO0FBQ1ZBLElBQUFBLE1BQU0sQ0FBQ04sVUFBUCxDQUFrQlMsR0FBbEI7QUFDQSxXQUFPSCxNQUFNLENBQUNDLE1BQWQ7QUFDRCxHQWxCSSxFQW1CTEcsS0FuQkssQ0FvQkwsVUFBQ1IsR0FBRCxFQUFTO0FBQ1AsVUFBTUEsR0FBTjtBQUNELEdBdEJJLENBQVA7QUF3QkQsQ0F6QkQ7O2VBMkJlTixZIiwic291cmNlc0NvbnRlbnQiOlsiLy8gZ2V0IHRoZSBjbGllbnRcbmltcG9ydCBteXNxbCBmcm9tICdteXNxbDInXG5cbi8vIGNyZWF0ZSB0aGUgY29ubmVjdGlvbiB0byBkYXRhYmFzZVxuZnVuY3Rpb24gY3JlYXRlQ29ubmVjdGlvbigpIHtcbiAgcmV0dXJuIG15c3FsLmNyZWF0ZUNvbm5lY3Rpb24oe1xuICAgIGhvc3Q6IHByb2Nlc3MuZW52LkRCSG9zdCxcbiAgICB1c2VyOiBwcm9jZXNzLmVudi5EQlVzZXIsXG4gICAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LkRCUGFzc3dvcmQsXG4gICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LkRCTmFtZSxcbiAgfSlcbn1cblxuY29uc3QgZ2V0VGFibGVMaXN0ID0gKCk6IFByb21pc2U8c3RyaW5nW10+ID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlPGFueT4oXG4gICAgKHJlcywgcmVqKSA9PiB7XG4gICAgICBjb25zdCBjb25uZWN0aW9uID0gY3JlYXRlQ29ubmVjdGlvbigpXG4gICAgICBjb25uZWN0aW9uLmV4ZWN1dGUoXG4gICAgICAgICdzaG93IHRhYmxlcycsXG4gICAgICAgIChlcnIsIHJlc3VsdHM6IG15c3FsLlJvd0RhdGFQYWNrZXRbXSkgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIHJlaihlcnIpXG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHRhYmxlc0xpc3Q6IHN0cmluZ1tdID0gcmVzdWx0cy5tYXAoKHJlc3VsdCkgPT4gcmVzdWx0W2BUYWJsZXNfaW5fJHtwcm9jZXNzLmVudi5EQk5hbWV9YF0pXG4gICAgICAgICAgcmVzKHtjb25uZWN0aW9uLCB0YWJsZXM6IHRhYmxlc0xpc3R9KVxuICAgICAgICB9XG4gICAgICApXG4gICAgfVxuICApLnRoZW4oXG4gICAgKHJlc3VsdCkgPT4ge1xuICAgICAgcmVzdWx0LmNvbm5lY3Rpb24uZW5kKClcbiAgICAgIHJldHVybiByZXN1bHQudGFibGVzXG4gICAgfVxuICApLmNhdGNoKFxuICAgIChlcnIpID0+IHtcbiAgICAgIHRocm93IGVyclxuICAgIH1cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBnZXRUYWJsZUxpc3RcbiJdfQ==